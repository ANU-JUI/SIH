<!-- upload_video.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Upload and Process Video</title>
</head>
<body>
    <form id="upload_form" method="post" enctype="multipart/form-data">
        {% csrf_token %}
        <label for="input_video">Choose a video file to process:</label>
        <input type="file" id="input_video" name="input_video" accept="video/mp4,video/mov">
        <button type="submit" id="upload_button">Upload Video</button>
    </form>

    <button id="process_button">Process Video</button>

    <video id="processed_video" width="640" height="480" controls></video>

    <script>
        document.getElementById('upload_button').addEventListener('click', function() {
            document.getElementById('upload_form').submit();
        });

        document.getElementById('process_button').addEventListener('click', function() {
            let formData = new FormData();
            formData.append('input_video', document.getElementById('input_video').files[0]);

            fetch('/process-video/', {
                method: 'POST',
                body: formData
            })
            .then(response => response.json())
            .then(data => {
                document.getElementById('processed_video').src = 'data:image/jpeg;base64,' + data.processed_frame;
            });
        });
    </script>
</body>
</html>